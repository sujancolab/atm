(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{"FrH+":function(t,e,a){"use strict";a.r(e);var s=a("eyXw"),i={name:"SiteWiseExpenses",components:{MonthPicker:s.a,MonthPickerInput:s.b},data:()=>({form:new Form({site_id:"",read_at:"",reading:[]}),read_at:"",pmModalData:"",created_users:[],search_machines:[],search_sites:[],search_tickets:[],search:{read_at:"",site_id:""},categories:[],sub_categories:[],sites:[],selected_machine:"",users:[],machines:[],Tickets:{},clearEmittedText:"",default_month:"",json_meta:[[{key:"charset",value:"utf-8"}]]}),methods:{calculateTotalHourmeter:t=>t.closing_hourmeter-t.starting_hourmeter,calculateTotalKm:t=>t.closing_km-t.starting_km,showClearText(){this.clearEmittedText="emitted",this.default_month="",window.setTimeout(()=>{this.clearEmittedText=null},1e3)},UpdateValues(t){this.search.tat_from=t.minValue,this.search.tat_to=t.maxValue},finishDownload(){Swal.close()},getLabel:t=>"object"==typeof t?t.far_no+" - "+t.name:t,getResults(t=1){""==this.form.read_at?Swal.fire("Search Date is required"):""==this.form.site_id?Swal.fire("Site ID is required"):(this.$Progress.start(),axios.post("/api/machine_data_reading_report",this.form).then(t=>{console.log(t.data.data),"data_available"==t.data.data?Swal.fire("Reading already available for the selected date and Site ID."):t.data.data.forEach(t=>{this.form.reading.push({id:t.id,machine_running_status:t.condition_of_machine,site_name:t.current_site.site_name,name:t.name,far_no:t.far_no,machine_model_name:t.machine_model.name,regn_no:t.regn_no,machine_sr_no:t.machine_sr_no,engine_no:t.engine_no,chassis_no:t.chassis_no,is_consumtion_hr_run:t.is_consumtion_hr,is_consumtion_km_run:t.is_consumtion_km_run,is_production_fig:t.is_production_fig,condition_of_machine:t.condition_of_machine})})}).catch(t=>{console.error(t)}),this.$Progress.finish())},submit_data(){this.$validator.validateAll().then(async t=>{t?(this.$Progress.start(),this.$route.params.id?this.form.put("api/reading/"+this.$route.params.id).then(t=>{1==t.data.success?(Toast.fire({icon:"success",title:"Data updated successfully"}),this.$router.push("/reading-data").catch(()=>{}),this.$Progress.end()):Toast.fire({icon:"warning",title:"Data could not get updated"})}):this.form.post("api/reading").then(t=>{console.log("vendor",t),1==t.data.success?(Toast.fire({icon:"success",title:"Data inserted successfully"}),this.$router.push("/reading-data").catch(()=>{}),this.$Progress.end()):Toast.fire({icon:"warning",title:"Data could not get inserted"})})):Toast.fire({icon:"warning",title:"Please check the validation"})})}},mounted(){if(this.$route.params.id){console.log(this.$route.params.id),this.form.id=this.$route.params.id;let t=this.$loading.show({container:this.$refs.ref_load_user});axios.get("api/reading/"+this.$route.params.id).then(e=>{this.form.site_id=e.data.data.site_id,this.form.read_at=e.data.data.read_at,this.form.reading=[],e.data.data.reading_data.forEach(t=>{this.form.reading.push({id:t.machine_id,starting_hourmeter:t.starting_hourmeter,closing_hourmeter:t.closing_hourmeter,starting_km:t.starting_km,closing_km:t.closing_km,daily_running_hour:t.daily_running_hour,diesel_issued:t.diesel_issued,machine_running_status:t.machine_running_status,site_name:t.machine.current_site.site_name,name:t.machine.name,far_no:t.machine.far_no,machine_model_name:t.machine.far_no,regn_no:t.machine.regn_no,machine_sr_no:t.machine.machine_sr_no,engine_no:t.machine.engine_no,chassis_no:t.machine.chassis_no,is_consumtion_hr_run:t.machine.is_consumtion_hr,is_consumtion_km_run:t.machine.is_consumtion_km_run,is_production_fig:t.machine.is_production_fig,condition_of_machine:t.machine.condition_of_machine})}),t.hide()}).catch(()=>{t.hide(),this.$router.push("/reading-data/").catch(()=>{})})}},created(){},beforeCreate(){axios.get("api/get_pre_machine").then(t=>{this.categories=t.data.data.Category,this.sites=t.data.data.sites}),axios.get("/api/initial_ticket").then(t=>{this.users=t.data.data.vendors,this.machines=t.data.data.machines,this.search_machines=t.data.data.machines,this.search_sites=t.data.data.sites,this.created_users=t.data.data.created_users}).catch(()=>console.warn("Oh. Something went wrong"))},watch:{}},n=a("JFUb"),r=Object(n.a)(i,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"content"},[a("div",{staticClass:"container-fluid"},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[a("div",{staticClass:"card"},[t._m(0),t._v(" "),a("div",{staticClass:"card-body p-2"},[a("form",{attrs:{autocomplete:"off"},on:{submit:function(e){return e.preventDefault(),t.getResults()}}},[a("div",{staticClass:"form-row"},[a("div",{staticClass:"col col-2"},[a("label",[t._v("Select Date")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.read_at,expression:"form.read_at"}],staticClass:"form-control",attrs:{type:"date",readonly:this.$route.params.id},domProps:{value:t.form.read_at},on:{input:function(e){e.target.composing||t.$set(t.form,"read_at",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"col col-2"},[a("label",[t._v("Select Site")]),t._v(" "),a("v-select",{attrs:{label:"site_name",reduce:function(t){return t.id},options:t.search_sites,placeholder:"Select Site...",name:"site_id",disabled:this.$route.params.id},model:{value:t.form.site_id,callback:function(e){t.$set(t.form,"site_id",e)},expression:"form.site_id"}})],1),t._v(" "),a("div",{staticClass:"col pt-4"},[this.$route.params.id?t._e():a("button",{staticClass:"btn btn-success",attrs:{type:"submit"}},[t._v("\n                                        Search\n                                    ")])])])])]),t._v(" "),a("div",{staticClass:"card-body table-responsive p-0 ticketTable"},[t.Tickets?a("table",{staticClass:"table table-hover table-striped"},[t._m(1),t._v(" "),a("tbody",t._l(t.form.reading,(function(e,s){return a("tr",{key:s},[a("td",[t._v(t._s(e.site_name))]),t._v(" "),a("td",[t._v(t._s(e.name))]),t._v(" "),a("td",[t._v(t._s(e.far_no))]),t._v(" "),a("td",[t._v(t._s(e.machine_model_name))]),t._v(" "),a("td",[t._v(t._s(e.regn_no))]),t._v(" "),a("td",[t._v(t._s(e.machine_sr_no))]),t._v(" "),a("td",[t._v(t._s(e.engine_no))]),t._v(" "),a("td",[t._v(t._s(e.chassis_no))]),t._v(" "),a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.starting_hourmeter,expression:"ticket.starting_hourmeter"}],staticClass:"form-control",attrs:{type:"number",readonly:0==e.is_consumtion_hr_run,name:"starting_hourmeter_"+s,"data-vv-as":"Starting hourmeter"},domProps:{value:e.starting_hourmeter},on:{input:function(a){a.target.composing||t.$set(e,"starting_hourmeter",a.target.value)}}})]),t._v(" "),a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.closing_hourmeter,expression:"ticket.closing_hourmeter"},{name:"validate",rawName:"v-validate",value:"min_value:"+e.starting_hourmeter,expression:"'min_value:' + ticket.starting_hourmeter"}],staticClass:"form-control",class:{"is-invalid":t.verrors.has("closing_hourmeter_"+s)},attrs:{type:"number",readonly:0==e.is_consumtion_hr_run,name:"closing_hourmeter_"+s,"data-vv-as":"Closing hourmeter"},domProps:{value:e.closing_hourmeter},on:{input:function(a){a.target.composing||t.$set(e,"closing_hourmeter",a.target.value)}}}),t._v(" "),t.verrors.has("closing_hourmeter_"+s)?a("div",{staticClass:"help-block invalid-feedback"},[t._v("\n                                            "+t._s(t.verrors.first("closing_hourmeter_"+s))+"\n                                        ")]):t._e()]),t._v(" "),a("td",[a("input",{staticClass:"form-control",attrs:{type:"number",readonly:""},domProps:{value:t.calculateTotalHourmeter(e)}})]),t._v(" "),a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.starting_km,expression:"ticket.starting_km"}],staticClass:"form-control",attrs:{type:"number",readonly:0==e.is_consumtion_km_run,name:"starting_km_"+s,"data-vv-as":"Starting KM"},domProps:{value:e.starting_km},on:{input:function(a){a.target.composing||t.$set(e,"starting_km",a.target.value)}}})]),t._v(" "),a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.closing_km,expression:"ticket.closing_km"},{name:"validate",rawName:"v-validate",value:"min_value:"+e.starting_km,expression:"'min_value:' + ticket.starting_km"}],staticClass:"form-control",class:{"is-invalid":t.verrors.has("closing_KM_"+s)},attrs:{type:"number",readonly:0==e.is_consumtion_km_run,name:"closing_KM_"+s,"data-vv-as":"Closing KM"},domProps:{value:e.closing_km},on:{input:function(a){a.target.composing||t.$set(e,"closing_km",a.target.value)}}}),t._v(" "),t.verrors.has("closing_KM_"+s)?a("div",{staticClass:"help-block invalid-feedback"},[t._v("\n                                            "+t._s(t.verrors.first("closing_KM_"+s))+"\n                                        ")]):t._e()]),t._v(" "),a("td",[a("input",{staticClass:"form-control",attrs:{type:"number",readonly:""},domProps:{value:t.calculateTotalKm(e)}})]),t._v(" "),a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.diesel_issued,expression:"ticket.diesel_issued"}],staticClass:"form-control",attrs:{type:"number"},domProps:{value:e.diesel_issued},on:{input:function(a){a.target.composing||t.$set(e,"diesel_issued",a.target.value)}}})]),t._v(" "),a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.condition_of_machine,expression:"ticket.condition_of_machine"}],staticClass:"form-control",attrs:{type:"text",readonly:""},domProps:{value:e.condition_of_machine},on:{input:function(a){a.target.composing||t.$set(e,"condition_of_machine",a.target.value)}}})])])})),0)]):t._e()])])]),t._v(" "),a("div",{staticClass:"col-12 pt-2 pb-2"},[a("button",{staticClass:"btn btn-success float-right",attrs:{type:"button"},on:{click:function(e){return t.submit_data()}}},[t._v("Submit")])])])])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"card-header"},[e("h3",{staticClass:"card-title"},[this._v("Data Reading Input")]),this._v(" "),e("div",{staticClass:"card-tools"})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("thead",[a("tr",[a("th",[t._v("Current Site")]),t._v(" "),a("th",[t._v("Name")]),t._v(" "),a("th",[t._v("FAR No")]),t._v(" "),a("th",[t._v("Model")]),t._v(" "),a("th",[t._v("Regn No")]),t._v(" "),a("th",[t._v("Machine Sr No")]),t._v(" "),a("th",[t._v("Engine No")]),t._v(" "),a("th",[t._v("Chassis No")]),t._v(" "),a("th",[t._v("Starting Hourmeter")]),t._v(" "),a("th",[t._v("Closing Hourmeter")]),t._v(" "),a("th",[t._v("Total Hourmeter")]),t._v(" "),a("th",[t._v("Starting KM")]),t._v(" "),a("th",[t._v("Closing KM")]),t._v(" "),a("th",[t._v("Total Km Run")]),t._v(" "),a("th",[t._v("Diesel Issued (Ltrs)")]),t._v(" "),a("th",[t._v("Machine running status")])])])}],!1,null,null,null);e.default=r.exports}}]);
//# sourceMappingURL=3.bundle.ca6ee4dd645be440ebc3.js.map