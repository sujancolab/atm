(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{"9Yv+":function(e,t,s){"use strict";s.r(t);var a=s("eyXw"),i={name:"CombinedExpenses",components:{MonthPicker:a.a,MonthPickerInput:a.b},data:()=>({pmModalData:"",created_users:[],search_machines:[],search_sites:[],search_tickets:[],search:{page:1,machine_id:"",site_id:"",category_id:"",sub_category_id:"",date_from:"",date_to:"",report_type:"machine wise"},categories:[],sub_categories:[],sites:[],selected_machine:"",users:[],machines:[],Tickets:{},clearEmittedText:"",default_month:"",json_fields:{"Machine Name":"name","FAR No":"far_no","Actual Material Expenses":"material_expenses","Actual Service Expenses":"service_expenses","Total Expenses":"total_expenses"},json_site_fields:{"Site Name":"site_name","Site ID":"site_id","Actual Material Expenses":"material_expenses","Actual Service Expenses":"service_expenses","Total Expenses":"total_expenses"},json_meta:[[{key:"charset",value:"utf-8"}]]}),methods:{showClearText(){this.clearEmittedText="emitted",this.default_month="",window.setTimeout(()=>{this.clearEmittedText=null},1e3)},async get_machine(){axios.get("/api/reports/machines",{params:{site_id:this.search.site_id,category_id:this.search.category_id,sub_category_id:this.search.sub_category_id}}).then(e=>{this.search_machines=e.data.data}).catch(()=>console.warn("Oh. Something went wrong"))},reset_filter(){this.search={page:1,machine_id:"",site_id:"",category_id:"",sub_category_id:"",monthYear:"",report_type:"machine wise"},this.getResults()},UpdateValues(e){this.search.tat_from=e.minValue,this.search.tat_to=e.maxValue},async export_csv(){this.search.report_type="machine wise"==this.search.report_type?"machine wise export":"site wise export";const e=await axios.post("api/reports",this.search);return this.search.report_type="machine wise export"==this.search.report_type?"machine wise":"site wise",e.data.data},startDownload(){Swal.fire({title:"Please Wait !",html:"Data populating",allowOutsideClick:!1,onBeforeOpen:()=>{Swal.showLoading()}})},finishDownload(){Swal.close()},getLabel:e=>"object"==typeof e?e.far_no+" - "+e.name:e,getResults(e=1){this.$Progress.start(),this.search.page=e,axios.post("/api/reports",this.search).then(e=>{this.Tickets=e.data.data}).catch(e=>{console.error(e)}),this.$Progress.finish()}},created(){this.getResults()},beforeCreate(){axios.get("api/get_pre_machine").then(e=>{this.categories=e.data.data.Category,this.sites=e.data.data.sites}),axios.get("/api/initial_ticket").then(e=>{this.users=e.data.data.vendors,this.machines=e.data.data.machines,this.search_machines=e.data.data.machines,this.search_sites=e.data.data.sites,this.created_users=e.data.data.created_users}).catch(()=>console.warn("Oh. Something went wrong"))},watch:{async"search.sub_category_id"(e,t){e&&this.get_machine()},async"search.site_id"(e,t){e&&this.get_machine()},"search.category_id":{handler:function(e,t){e&&(axios.get("api/category/"+e).then(e=>{this.sub_categories=e.data.data}),this.get_machine())},deep:!0,initial:!0}}},c=s("JFUb"),r=Object(c.a)(i,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("section",{staticClass:"content"},[s("div",{staticClass:"container-fluid"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-12"},[s("div",{staticClass:"card"},[e._m(0),e._v(" "),s("div",{staticClass:"card-body p-2"},[s("form",{attrs:{autocomplete:"off"},on:{submit:function(t){return t.preventDefault(),e.getResults()}}},[s("div",{staticClass:"form-row"},[s("div",{staticClass:"col col-2"},[s("div",{staticClass:"form-check"},[s("label",{staticClass:"form-check-label"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.search.report_type,expression:"search.report_type"}],staticClass:"form-check-input",attrs:{type:"radio",name:"optradio",value:"site wise"},domProps:{checked:e._q(e.search.report_type,"site wise")},on:{change:function(t){return e.$set(e.search,"report_type","site wise")}}}),e._v("Site Wise\n                                        ")])]),e._v(" "),s("div",{staticClass:"form-check"},[s("label",{staticClass:"form-check-label"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.search.report_type,expression:"search.report_type"}],staticClass:"form-check-input",attrs:{type:"radio",name:"optradio",value:"machine wise"},domProps:{checked:e._q(e.search.report_type,"machine wise")},on:{change:function(t){return e.$set(e.search,"report_type","machine wise")}}}),e._v("Machine Wise\n                                        ")])])]),e._v(" "),s("div",{staticClass:"col col-2"},[s("v-select",{attrs:{label:"site_name",reduce:function(e){return e.id},options:e.search_sites,placeholder:"Select Site...",name:"site_id"},model:{value:e.search.site_id,callback:function(t){e.$set(e.search,"site_id",t)},expression:"search.site_id"}})],1),e._v(" "),s("div",{staticClass:"col col-2"},[s("datetime",{attrs:{"value-zone":"Asia/Kolkata","input-class":"form-control",placeholder:"Created from date"},model:{value:e.search.date_from,callback:function(t){e.$set(e.search,"date_from",t)},expression:"search.date_from"}})],1),e._v(" "),s("div",{staticClass:"col col-2"},[s("datetime",{attrs:{"value-zone":"Asia/Kolkata","input-class":"form-control",placeholder:"Created to date"},model:{value:e.search.date_to,callback:function(t){e.$set(e.search,"date_to",t)},expression:"search.date_to"}})],1),e._v(" "),s("div",{staticClass:"col col-3"},[s("v-select",{attrs:{label:"name",reduce:function(e){return e.id},options:e.categories,placeholder:"Choose Category ..."},model:{value:e.search.category_id,callback:function(t){e.$set(e.search,"category_id",t)},expression:"search.category_id"}},[e._v("\\\n                                        ")])],1),e._v(" "),s("div",{staticClass:"col col-3"},[s("v-select",{attrs:{label:"name",reduce:function(e){return e.id},options:e.sub_categories,placeholder:"Choose description ..."},model:{value:e.search.sub_category_id,callback:function(t){e.$set(e.search,"sub_category_id",t)},expression:"search.sub_category_id"}})],1),e._v(" "),s("div",{staticClass:"col col-2"},[s("v-select",{attrs:{label:"name","get-option-label":e.getLabel,reduce:function(e){return e.id},options:e.search_machines,placeholder:"Enter machines ...",name:"machine_id"},model:{value:e.search.machine_id,callback:function(t){e.$set(e.search,"machine_id",t)},expression:"search.machine_id"}})],1),e._v(" "),s("div",{staticClass:"col"},[s("button",{staticClass:"btn btn-success",attrs:{type:"submit"}},[e._v("\n                                            Search\n                                        ")]),e._v(" "),s("button",{staticClass:"btn btn-info ml-2",attrs:{type:"button"},on:{click:function(t){return e.reset_filter()}}},[e._v("\n                                            Reset\n                                        ")]),e._v(" "),"machine wise"==e.search.report_type?s("download-excel",{staticClass:"btn btn-warning ml-2",attrs:{fetch:e.export_csv,fields:e.json_fields,"before-generate":e.startDownload,"before-finish":e.finishDownload,worksheet:"My Worksheet",type:"csv",name:"machine_expenses.csv"}},[s("span",{staticClass:"labelText"},[s("i",{staticClass:"fa fa-file-excel-o",attrs:{"aria-hidden":"true"}}),e._v("\n                                                Export as CSV")])]):s("download-excel",{staticClass:"btn btn-warning ml-2",attrs:{fetch:e.export_csv,fields:e.json_site_fields,"before-generate":e.startDownload,"before-finish":e.finishDownload,worksheet:"My Worksheet",type:"csv",name:"site_expenses.csv"}},[s("span",{staticClass:"labelText"},[s("i",{staticClass:"fa fa-file-excel-o",attrs:{"aria-hidden":"true"}}),e._v("\n                                                Export as CSV")])])],1)])])]),e._v(" "),s("div",{staticClass:"card-body table-responsive p-0 ticketTable"},[e.Tickets&&e.Tickets.records?s("table",{staticClass:"table table-hover table-striped"},[s("thead",[s("tr",[s("th",[e._v(e._s("machine wise"==e.search.report_type?"Machine Name":"Site Name"))]),e._v(" "),s("th",[e._v(e._s("machine wise"==e.search.report_type?"FAR No":"Site ID"))]),e._v(" "),s("th",[e._v("Actual Material Expenses ")]),e._v(" "),s("th",[e._v("Actual Service Expenses")]),e._v(" "),s("th",[e._v("Total Expenses")])])]),e._v(" "),s("tbody",e._l(e.Tickets.records.data,(function(t){return s("tr",{key:t.id,class:t.row_color},[s("td",[e._v(" "+e._s("machine wise"==e.search.report_type?t.name:t.site_name))]),e._v(" "),s("td",[e._v(" "+e._s("machine wise"==e.search.report_type?t.far_no:t.site_id))]),e._v(" "),s("td",[e._v(e._s(e._f("toCurrency")(t.material_expenses)))]),e._v(" "),s("td",[e._v(e._s(e._f("toCurrency")(t.service_expenses)))]),e._v(" "),s("td",[e._v(e._s(e._f("toCurrency")(t.total_expenses)))])])})),0),e._v(" "),s("tfoot",[s("tr",{staticClass:"table-dark"},[s("td",{attrs:{colspan:"2"}},[e._v("Total")]),e._v(" "),s("td",[e.Tickets&&e.Tickets.actual_material_cost?s("span",[e._v(e._s(e._f("toCurrency")(e.Tickets.actual_material_cost)))]):e._e()]),e._v(" "),s("td",[e.Tickets&&e.Tickets.actual_service_cost?s("span",[e._v(e._s(e._f("toCurrency")(e.Tickets.actual_service_cost)))]):e._e()]),e._v(" "),s("td",[e._v(e._s(e._f("toCurrency")(e.Tickets.actual_material_cost+e.Tickets.actual_service_cost)))])])])]):e._e()]),e._v(" "),e.Tickets&&e.Tickets.records?s("div",{staticClass:"card-footer"},[s("pagination",{attrs:{data:e.Tickets.records},on:{"pagination-change-page":e.getResults}})],1):e._e()])])])])])}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"card-header"},[t("h3",{staticClass:"card-title"},[this._v("Combined Expense Expenses Report")]),this._v(" "),t("div",{staticClass:"card-tools"})])}],!1,null,null,null);t.default=r.exports}}]);
//# sourceMappingURL=17.bundle.7ef426f9ba6fd4051b4c.js.map